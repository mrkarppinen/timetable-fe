(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(t,e,n){t.exports=n(56)},42:function(t,e,n){},56:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(26),o=n.n(i),l=(n(42),n(8)),c=n(9),u=n(15),s=n(13),m=n(14),d=n(16),p=n(27),f=new(n.n(p).a),b=function(t){var e="string"===typeof t?[Promise.resolve(f.get(t,h())).then(function(e){return Object(d.a)({},e,{id:t})})]:t.map(function(t){return Promise.resolve(f.get(t,h())).then(function(e){return Object(d.a)({},e,{id:t})})});return Promise.all(e).then(function(t){return{timetables:t}})},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,e=t.getDate(),n=t.getMonth()+1,a=t.getFullYear();return e=("0"+e).substr(-2),n=("0"+n).substr(-2),"".concat(a).concat(n).concat(e)},g=function(){return{type:"fetch_timetables_done",timetables:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}},v=n(5),y=n(6),O=n(30),j=n.n(O),E=n(7),k=function(t){var e=Math.floor(t/60/60);return"0".concat(e=e>=24?e-24:e).slice(-2)},x=function(t){return"0".concat(Math.floor(t/60%60)).slice(-2)},w=function(t){var e=t.value,n=k(e),a=x(e);return r.a.createElement(r.a.Fragment,null,n,":",a)};function S(){var t=Object(y.a)(["\n    font-size: 0.75rem;\n    font-style: italic;\n"]);return S=function(){return t},t}var F=E.a.small(S()),_=function(t){var e=t.time,n=t.lines;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{value:e}),r.a.createElement(F,null,n.join()))},D=n(60),I=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).state={departures:n.props.timetable?n.getDepartures(n.props.timetable,new Date,3):[]},n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"update",value:function(){this.setState({departures:this.props.timetable?this.getDepartures(this.props.timetable,new Date,3):[]})}},{key:"render",value:function(){var t=this,e=this.state.departures;return r.a.createElement("div",{className:"list-item"},r.a.createElement("h2",{onClick:function(){t.props.history.push("/stop/"+t.props.index)},style:{cursor:"pointer"}},this.props.title," (",this.props.id,")"),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},e.length>0&&e.map(function(t){return r.a.createElement("div",{key:t.time},r.a.createElement(_,{time:t.time,lines:t.lines}))})),r.a.createElement(j.a,{timeout:1e3,enabled:!0,callback:function(){return t.update()}}))}},{key:"getDepartures",value:function(t,e,n){var a=60*(60*e.getHours()+e.getMinutes());return t.filter(function(t){return t.time>a}).slice(0,n)}}]),e}(r.a.Component),C=Object(D.a)(I),M=n(12),N=function(){function t(){Object(l.a)(this,t),this.key="stops",this.separator=";"}return Object(c.a)(t,[{key:"getStops",value:function(){var t=window.localStorage.getItem(this.key);return null==t||0===t.length?[]:t.split(this.separator)}},{key:"addStop",value:function(t){var e=this.getStops();e.push(t),this.saveIds(e)}},{key:"delete",value:function(t){var e=this.getStops(),n=e.indexOf(t);e.splice(n,1),this.saveIds(e)}},{key:"saveIds",value:function(t){window.localStorage.setItem(this.key,t.join(this.separator))}}]),t}();function A(){var t=Object(y.a)(["\n    background: none;\n    /*border: 1px solid #ccc;\n    border-radius: 15px;*/\n    border: none;\n    padding: 1rem;\n\n    :focus {\n        outline: none;\n    }\n"]);return A=function(){return t},t}function P(){var t=Object(y.a)(["\n    display: flex;\n    flex-direction: column;\n    margin: auto;\n    margin-top: 1rem;\n    width: 150px;\n\n    input, button {\n        margin-bottom: 1rem;\n    }\n\n    input {\n        text-align: center;\n        border: none;\n        border-bottom: 1px solid #ccc;\n    }\n"]);return P=function(){return t},t}function z(){var t=Object(y.a)(["\n    width: 100px;\n    height: 40px;\n    background: none;\n    /*border: 1px solid #ccc;\n    border-radius: 10px;*/\n    border: none;\n    color: #ccc;\n    font-size: 1.5rem;\n\n    :focus{\n        outline: none;\n    }\n\n"]);return z=function(){return t},t}var J=E.a.button(z()),L=E.a.form(P()),B=E.a.button(A()),H=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).state={displayForm:!1},n.toggleForm=n.toggleForm.bind(Object(M.a)(Object(M.a)(n))),n.onSubmit=n.onSubmit.bind(Object(M.a)(Object(M.a)(n))),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"toggleForm",value:function(){this.setState({displayForm:!this.state.displayForm})}},{key:"onSubmit",value:function(t){t.preventDefault();var e=t.target.stopId.value;e.trim().length>0&&(this.props.onAdd(e),(new N).addStop(e)),t.target.stopId.value="",this.toggleForm()}},{key:"render",value:function(){var t=this.state.displayForm?"close-form":"open-form",e=this.state.displayForm?"-":"+";return r.a.createElement("div",{className:"new-form",style:{marginTop:"1rem"}},r.a.createElement("div",null,r.a.createElement(J,{id:t,type:"button",onClick:this.toggleForm},e)),this.state.displayForm&&r.a.createElement(L,{id:"add-form",onSubmit:this.onSubmit,autoComplete:"off"},r.a.createElement("input",{type:"text",name:"stopId",placeholder:"id"}),r.a.createElement(B,{id:"submit-form",type:"submit"},"Add")))}}]),e}(r.a.Component),T=Object(v.b)(function(t){return{}},function(t){return{onAdd:function(e){t(function(t){return function(e){return e({type:"fetch_one_start"}),b(t).then(function(t){e(g(t.timetables))}).catch(function(t){console.error(t),e(g())})}}(e))}}})(H);function Y(){var t=Object(y.a)(["\n    display: flex;\n    text-align: center;\n    flex-direction: column;\n"]);return Y=function(){return t},t}var q=E.a.div(Y()),G=function(t){var e=t.loading,n=t.timetables;return r.a.createElement(q,{className:"list"},e&&r.a.createElement("div",{id:"loading"},"Loading...."),!e&&n.map(function(t,e){return r.a.createElement(C,Object.assign({key:t.title},t,{index:e}))}),r.a.createElement(T,null))},K=Object(v.b)(function(t){return{loading:t.timetable.loading,timetables:t.timetable.list}},function(t){return{}})(G);function Q(){var t=Object(y.a)(["\ndisplay: flex;\nflex-direction: column;\nh1 {\n    text-align: center;\n}\n\ndiv {\n    width: 50px;\n    margin: auto;\n}\n"]);return Q=function(){return t},t}var R=E.a.div(Q()),U=function(t){var e=t.title,n=t.loaded,a=t.timetable,i=t.id;return r.a.createElement("div",null,!n&&r.a.createElement("div",null,"Loading..."),n&&r.a.createElement(R,null,r.a.createElement("h1",null,e," (",i,")"),a.map(function(t){return r.a.createElement("div",{key:t.time},r.a.createElement(_,{time:t.time,lines:t.lines}))})))},V=Object(v.b)(function(t,e){var n=e.match.params.id,a=!1,r={title:"",timetable:[],id:""};return t.timetable.list&&t.timetable.list.length>0&&(r=t.timetable.list[n],a=!0),{title:r.title,timetable:r.timetable,loaded:a,id:r.id}},function(){return{}})(U),W=n(58),X=n(59),Z=n(57),$=function(t){function e(t){return Object(l.a)(this,e),Object(u.a)(this,Object(s.a)(e).call(this,t))}return Object(m.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){console.log("loading");var t=new N;t.getStops().length>0&&this.props.onMount(t.getStops())}},{key:"render",value:function(){return r.a.createElement(W.a,null,r.a.createElement("div",{className:"app"},r.a.createElement(X.a,null,r.a.createElement(Z.a,{path:"/stop/:id?",component:V}),r.a.createElement(Z.a,{path:"*",component:K}))))}}]),e}(a.Component),tt=Object(v.b)(function(t){return{}},function(t){return{onMount:function(e){return t(function(t){return function(e){return e({type:"feth_timetables_start"}),b(t).then(function(t){e(g(t.timetables))}).catch(function(t){console.error(t),e(g())})}}(e))}}})($),et=n(11),nt=Object(et.c)({timetable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,list:[],loadingOne:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"feth_timetables_start":return{loading:!0,list:[],loadingOne:!1};case"fetch_timetables_done":return{loading:!1,list:t.list.concat(e.timetables),loadingOne:!1};case"fetch_one_start":return Object(d.a)({},t,{loadingOne:!0});default:return t}}}),at=n(35),rt=Object(et.d)(nt,Object(et.a)(at.a));o.a.render(r.a.createElement(v.a,{store:rt},r.a.createElement(tt,null)),document.getElementById("root"))}},[[37,2,1]]]);
//# sourceMappingURL=main.f80b43e7.chunk.js.map