(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(t,e,n){t.exports=n(55)},41:function(t,e,n){},55:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(24),o=n.n(i),l=(n(41),n(8)),c=n(9),u=n(15),s=n(13),m=n(14),d=n(25),p=new(n.n(d).a),f=function(t){var e="string"===typeof t?[Promise.resolve(p.get(t,b()))]:t.map(function(t){return Promise.resolve(p.get(t,b()))});return Promise.all(e).then(function(t){return{timetables:t}})},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,e=t.getDate(),n=t.getMonth()+1,a=t.getFullYear();return e=("0"+e).substr(-2),n=("0"+n).substr(-2),"".concat(a).concat(n).concat(e)},h=function(){return{type:"fetch_timetables_done",timetables:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}},g=n(4),v=n(6),y=n(28),O=n.n(y),j=n(7),E=function(t){var e=Math.floor(t/60/60);return"0".concat(e=e>=24?e-24:e).slice(-2)},k=function(t){return"0".concat(Math.floor(t/60%60)).slice(-2)},x=function(t){var e=t.value,n=E(e),a=k(e);return r.a.createElement(r.a.Fragment,null,n,":",a)};function w(){var t=Object(v.a)(["\n    font-size: 0.75rem;\n    font-style: italic;\n"]);return w=function(){return t},t}var S=j.a.small(w()),_=function(t){var e=t.time,n=t.lines;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{value:e}),r.a.createElement(S,null,n.join()))},F=n(58),I=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).state={departures:n.props.timetable?n.getDepartures(n.props.timetable,new Date,3):[]},n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"update",value:function(){this.setState({departures:this.props.timetable?this.getDepartures(this.props.timetable,new Date,3):[]})}},{key:"render",value:function(){var t=this,e=this.state.departures;return r.a.createElement("div",{className:"list-item"},r.a.createElement("h2",{onClick:function(){t.props.history.push("/stop/"+t.props.index)},style:{cursor:"pointer"}},this.props.title),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},e.length>0&&e.map(function(t){return r.a.createElement("div",{key:t.time},r.a.createElement(_,{time:t.time,lines:t.lines}))})),r.a.createElement(O.a,{timeout:1e3,enabled:!0,callback:function(){return t.update()}}))}},{key:"getDepartures",value:function(t,e,n){var a=60*(60*e.getHours()+e.getMinutes());return t.filter(function(t){return t.time>a}).slice(0,n)}}]),e}(r.a.Component),D=Object(F.a)(I),C=n(12),M=function(){function t(){Object(l.a)(this,t),this.key="stops",this.separator=";"}return Object(c.a)(t,[{key:"getStops",value:function(){var t=window.localStorage.getItem(this.key);return null==t||0===t.length?[]:t.split(this.separator)}},{key:"addStop",value:function(t){var e=this.getStops();e.push(t),this.saveIds(e)}},{key:"delete",value:function(t){var e=this.getStops(),n=e.indexOf(t);e.splice(n,1),this.saveIds(e)}},{key:"saveIds",value:function(t){window.localStorage.setItem(this.key,t.join(this.separator))}}]),t}();function A(){var t=Object(v.a)(["\n    display: flex;\n    flex-direction: column;\n    margin: auto;\n    margin-top: 1rem;\n    width: 150px;\n\n    input, button {\n        margin-bottom: 1rem;\n    }\n\n    input {\n        text-align: center;\n    }\n"]);return A=function(){return t},t}function N(){var t=Object(v.a)(["\n    width: 100px;\n    height: 40px;\n    background: none;\n    border: 1px solid #ccc;\n    border-radius: 10px;\n    color: #ccc;\n    font-size: 1.5rem;\n\n"]);return N=function(){return t},t}var P=j.a.button(N()),L=j.a.form(A()),T=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).state={displayForm:!1},n.toggleForm=n.toggleForm.bind(Object(C.a)(Object(C.a)(n))),n.onSubmit=n.onSubmit.bind(Object(C.a)(Object(C.a)(n))),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"toggleForm",value:function(){this.setState({displayForm:!this.state.displayForm})}},{key:"onSubmit",value:function(t){t.preventDefault();var e=t.target.stopId.value;e.trim().length>0&&(this.props.onAdd(e),(new M).addStop(e)),t.target.stopId.value="",this.toggleForm()}},{key:"render",value:function(){var t=this.state.displayForm?"close-form":"open-form",e=this.state.displayForm?"-":"+";return r.a.createElement("div",{className:"new-form",style:{marginTop:"1rem"}},r.a.createElement("div",null,r.a.createElement(P,{id:t,type:"button",onClick:this.toggleForm},e)),this.state.displayForm&&r.a.createElement(L,{id:"add-form",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",name:"stopId"}),r.a.createElement("button",{id:"submit-form",type:"submit"},"Add")))}}]),e}(r.a.Component),B=Object(g.b)(function(t){return{}},function(t){return{onAdd:function(e){t(function(t){return function(e){return e({type:"fetch_one_start"}),f(t).then(function(t){e(h(t.timetables))}).catch(function(t){console.error(t),e(h())})}}(e))}}})(T);function R(){var t=Object(v.a)(["\n    display: flex;\n    text-align: center;\n    flex-direction: column;\n"]);return R=function(){return t},t}var z=j.a.div(R()),J=function(t){var e=t.loading,n=t.timetables;return r.a.createElement(z,{className:"list"},e&&r.a.createElement("div",{id:"loading"},"Loading...."),!e&&n.map(function(t,e){return r.a.createElement(D,Object.assign({key:t.title},t,{index:e}))}),r.a.createElement(B,null))},U=Object(g.b)(function(t){return{loading:t.timetable.loading,timetables:t.timetable.list}},function(t){return{}})(J);function V(){var t=Object(v.a)(["\ndisplay: flex;\nflex-direction: column;\nh1 {\n    text-align: center;\n}\n\ndiv {\n    width: 50px;\n    margin: auto;\n}\n"]);return V=function(){return t},t}var H=j.a.div(V()),Y=function(t){var e=t.title,n=t.loaded,a=t.timetable;return r.a.createElement("div",null,!n&&r.a.createElement("div",null,"Loading..."),n&&r.a.createElement(H,null,r.a.createElement("h1",null,e),a.map(function(t){return r.a.createElement("div",{key:t.time},r.a.createElement(_,{time:t.time,lines:t.lines}))})))},q=Object(g.b)(function(t,e){var n=e.match.params.id,a=!1,r={title:"",timetable:[]};return t.timetable.list&&t.timetable.list.length>0&&(r=t.timetable.list[n],a=!0),{title:r.title,timetable:r.timetable,loaded:a}},function(){return{}})(Y),G=n(57),K=n(56),Q=function(t){function e(t){return Object(l.a)(this,e),Object(u.a)(this,Object(s.a)(e).call(this,t))}return Object(m.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){console.log("loading");var t=new M;t.getStops().length>0&&this.props.onMount(t.getStops())}},{key:"render",value:function(){return r.a.createElement(G.a,null,r.a.createElement("div",{className:"app"},r.a.createElement(K.a,{exact:!0,path:"/",component:U}),r.a.createElement(K.a,{path:"/stop/:id?",component:q})))}}]),e}(a.Component),W=Object(g.b)(function(t){return{}},function(t){return{onMount:function(e){return t(function(t){return console.log(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_TIMETABLE_SERVICE),function(e){return e({type:"feth_timetables_start"}),f(t).then(function(t){console.log(t),e(h(t.timetables))}).catch(function(t){console.error(t),e(h())})}}(e))}}})(Q),X=n(11),Z=n(34),$=Object(X.c)({timetable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,list:[],loadingOne:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"feth_timetables_start":return{loading:!0,list:[],loadingOne:!1};case"fetch_timetables_done":return{loading:!1,list:t.list.concat(e.timetables),loadingOne:!1};case"fetch_one_start":return Object(Z.a)({},t,{loadingOne:!0});default:return t}}}),tt=n(33),et=Object(X.d)($,Object(X.a)(tt.a));o.a.render(r.a.createElement(g.a,{store:et},r.a.createElement(W,null)),document.getElementById("root"))}},[[36,2,1]]]);
//# sourceMappingURL=main.878567a8.chunk.js.map